<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><title>GCP AutoML Tables - Kevin's Page</title><link rel="shortcut icon" href="http://localhost:4000/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="http://localhost:4000/assets/css/just-the-docs.css"> <script type="text/javascript" src="http://localhost:4000/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="http://localhost:4000/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>GCP AutoML Tables | Kevin’s Page</title><meta name="generator" content="Jekyll v3.8.6" /><meta property="og:title" content="GCP AutoML Tables" /><meta property="og:locale" content="en_US" /><meta name="description" content="Kevin’s Page" /><meta property="og:description" content="Kevin’s Page" /><link rel="canonical" href="http://localhost:4000/docs/machine-learning/2019-12-26-gcp-automl-tables/" /><meta property="og:url" content="http://localhost:4000/docs/machine-learning/2019-12-26-gcp-automl-tables/" /><meta property="og:site_name" content="Kevin’s Page" /> <script type="application/ld+json"> {"url":"http://localhost:4000/docs/machine-learning/2019-12-26-gcp-automl-tables/","description":"Kevin’s Page","headline":"GCP AutoML Tables","@type":"WebPage","@context":"https://schema.org"}</script><body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"><title>Link</title><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path> </symbol> </svg><div class="page-wrap"><div class="side-bar"><div class="site-header"> <a href="http://localhost:4000" class="site-title lh-tight"> Kevin's Page </a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button></div><div class="navigation main-nav js-main-nav"><nav role="navigation" aria-label="Main navigation"><ul class="navigation-list"><li class="navigation-list-item"><a href="http://localhost:4000/" class="navigation-list-link">Home</a><li class="navigation-list-item active"><a href="http://localhost:4000/docs/ml" class="navigation-list-link">Machine Learning</a><ul class="navigation-list-child-list "><li class="navigation-list-item active"><a href="http://localhost:4000/docs/machine-learning/2019-12-26-gcp-automl-tables/" class="navigation-list-link active">GCP AutoML Tables</a></ul></ul></nav></div><footer class="site-footer"><p class="text-small text-grey-dk-000 mb-4">Kevin's Page</p></footer></div><div class="main-content-wrap js-main-content" tabindex="0"><div class="main-content"><div class="page-header js-page-header"><div class="search"><div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search Kevin's Page" aria-label="Search Kevin's Page" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg></div><div class="js-search-results search-results-wrap"></div></div><ul class="list-style-none text-small aux-nav"><li class="d-inline-block my-0"><a href="//github.com/hisdream86">GitHub</a></ul></div><div class="page"><nav class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/docs/ml">Machine Learning</a><li class="breadcrumb-nav-list-item"><span>GCP AutoML Tables</span></ol></nav><div id="main-content" class="page-content" role="main"><h1 id="google-automl-tables"> <a href="#google-automl-tables" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Google AutoML Tables</h1><p>Google Cloud 에서 제공하는 기계학습 서비스 중 하나인 <a href="https://cloud.google.com/automl-tables/">AutoML Tables</a>에 대한 간략한 내용 및 유의사항을 정리한다.</p><p><br /></p><h2 id="automl-tables"> <a href="#automl-tables" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> AutoML Tables</h2><p>AutoML Tables은 구조화된 데이터(Structured data)를 기반으로 자동화된 <strong>지도학습(Supervised learning)</strong> 및 모델 배포를 지원하는 서비스이다. 기존에는 학습 단계에서 모델 성능 개선을 위해 다양한 노력들이 필요했는데(알고리즘 선정, 구현, 파라미터 튜닝 등), AutoML은 스스로 다양한 알고리즘들과 파라미터들을 조절해가면서 최적의 모델을 찾아주는 기능을 제공한다.</p><p>쉽게 말해서, 기계학습에 대한 지식이나 큰 노력 없이 비즈니스에 필요한 학습모델을 찾아낼 수 있도록 도와주는 서비스라고 보면 되겠다.</p><p>현재는 베타 버전으로, 프로덕션 적용을 위해서는 어느정도 직접 고도화하는 노력은 필요해 보인다.</p><blockquote><p><em>At beta, products or features are ready for broader customer testing and use. Betas are often publicly announced. There are no SLAs or technical support obligations in a beta release unless otherwise specified in product terms or the terms of a particular beta program. The average beta phase lasts about six months.</em></p></blockquote><p><br /></p><h2 id="features"> <a href="#features" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Features</h2><h3 id="model-quality"> <a href="#model-quality" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Model quality</h3><p>Google 에서 보유한 다양한 State-of-the-art 알고리즘들을 기반으로 최적의 모델 성능을 제공한다. 일단 구글에서 구현했으니 충분히(?) 믿고 사용하면 되겠다는 생각이 든다.</p><h3 id="feature-engineering"> <a href="#feature-engineering" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Feature engineering</h3><p>데이터에 대한 통계 바탕으로 손쉽게 Feature 엔지니어링을 할 수 있도록 지원한다. 오해하면 안되는게 이를 자동으로 해준다는 것은 아니다. 제공되는 통계를 바탕으로 어느 정도는 직접 Feature를 선택하는 노력이 필요하다.</p><h3 id="model-deployment--serving"> <a href="#model-deployment--serving" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Model deployment &amp; serving</h3><p>Google이 보유한 확장성있는 환경에서의 모델 배포 및 serving을 지원하므로 프로덕션 환경에 빠르게 적용이 가능하다.</p><blockquote><p><em>하지만, 현재 베타 버전을 기준으로 GCP에서 직접 제공하는 Online Prediction을 프로덕션에 적용하는것은 어려워보인다(뒤에서 자세히 설명).</em></p></blockquote><p><br /></p><h2 id="preparing-training-data"> <a href="#preparing-training-data" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Preparing training data</h2><p>당연한 이야기지만 학습을 위해서는 먼저 데이터를 준비하는 과정이 필요하다. 아래는 AutoML Tables 에서 학습 데이터의 준비를 위해 어떤 과정들이 필요한지에 대해 설명한다.</p><h3 id="1-문제-타입-결정"> <a href="#1-문제-타입-결정" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> 1) 문제 타입 결정</h3><p>풀고자 하는 문제의 타입이 <strong>Classification</strong>인지, <strong>Regression</strong>인지 결정한다.</p><ul><li>Classification: Categorical value를 예측<li>Regression: Numeric value를 예측</ul><p>문제 타입은 추후 AutoML Tables의 파라미터로 입력된다.</p><blockquote><p><em>Classification 문제의 경우 target 개수 범위는 [2, 500] 이어야한다.</em></p></blockquote><h3 id="2-학습용으로-사용할-데이터-결정"> <a href="#2-학습용으로-사용할-데이터-결정" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> 2) 학습용으로 사용할 데이터 결정</h3><p>AutoML Tables은 아래와 같은 학습 데이터 제약사항을 가지므로, 데이터 준비 시 이를 유의해야 한다.</p><ul><li>It must be 100 GB or smaller.<li>The value you want to predict (your target column) must be included.<li>There must be at least two and no more than 1,000 columns.<li>There must be at least 1,000 and no more than 100,000,000 rows.</ul><blockquote><p><em>보유하고 있는 데이터가 너무 큰 경우, 중요한 Feature만 선택하거나 영향력이 큰 Row만 선택(ex. 보다 최신의 데이터)하는 전략이 필요해 보인다.</em></p></blockquote><h3 id="3-추가적인-속성-정의"> <a href="#3-추가적인-속성-정의" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> 3) 추가적인 속성 정의</h3><p>보다 정교한 학습을 위해 아래의 메타 속성들을 데이터 Column에 추가해서 사용할 수 있다.</p><p><strong>Data Split Column</strong>은 각 row가 어떤 용도로 사용될지 지정하는 컬럼으로, 아래와 같은 조합으로 사용이 가능하다.</p><ul><li>All of TRAIN, VALIDATE, and TEST<li>Only TEST and UNASSIGNED</ul><blockquote><p><em>UNASSIGNED의 경우, AutoML Tables가 자동으로 training 와 validation set으로 나눈다.</em></p></blockquote><p><strong>Time Column</strong>은 Timestamp 형식의 값을 지니는 컬럼으로, 해당 row가 언제 발생한 데이터인지를 지정하기 위한 용도이다. 이 컬럼을 지정한 경우 AutoML Tables는 가장 오래된 80%는 training, 다음 10%는 validation, 마지막 최신 10%는 test 용도로 사용한다.</p><p><strong>Weight Column</strong>은 특정 row에 가중치를 부여하기 위한 컬럼이다. [0, 10000] 범위의 값이 지정 가능하며, 높을수록 더 많은 가중치를 부여받게 된다.</p><h3 id="4-데이터-import-source-준비"> <a href="#4-데이터-import-source-준비" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> 4) 데이터 Import source 준비</h3><p>AutoML Tables로 학습 데이터를 전달하기 위한 방법은 두 가지가 존재한다. 아래의 방법 중 보다 본인에게 적절한 방법을 선택하고 데이터를 미리 준비한다.</p><ul><li><a href="https://cloud.google.com/automl-tables/docs/prepare#bq">Using BigQuery</a><li><a href="https://cloud.google.com/automl-tables/docs/prepare#csv">Using CSV files</a></ul><p>BigQuery 테이블을 Import 하는 경우, 별도의 데이터 스키마를 지정할 필요가 없기 때문에 편리하다.</p><blockquote><p><em>단, 현재 버전 기준으로 BigQuery dataset이 US 또는 EU 리전에 존재해야 한다.</em></p></blockquote><p><br /></p><h2 id="training"> <a href="#training" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Training</h2><p>학습 데이터가 잘 준비되었으면 이제 실제 모델을 학습시킬 수 있다.</p><p>앞서 설명처럼 학습 관련 작업은 크게 할 것이 없다. <a href="#preparing-training-data">Preparing training data</a> 단계에서 결정된 사항들이나 간단한 필수 설정값(ex. 학습 시간, target column)들을 AutoML Tables에서 제공하는 인터페이스(<a href="https://cloud.google.com/automl-tables/docs/train#automl-tables-model-create-console">GCP Console</a> 또는<a href="https://cloud.google.com/automl-tables/docs/train#automl-tables-model-create-cli-curl">Restful API</a>)를 통해 지정하고 학습을 시작하면 된다. 자세한 사용 방법은 링크된 페이지를 참고한다.</p><h3 id="참고사항"> <a href="#참고사항" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> 참고사항</h3><p><strong>Training budget 설정</strong></p><p>AutoML Tables의 <a href="https://cloud.google.com/automl-tables/pricing">과금 정책</a>은 Compuing 시간 당 비용이다. 따라서 시간(Hour)값의 예산을 설정해야 하는데, 이를 모두 사용하기 전에 성능이 수렴했다고 판단되면 미리 학습이 종료되기도 한다(Ealry Stopping). 물론 이 옵션을 끌수도 있다.</p><p><strong>최적화 목표 설정</strong></p><p>별도의 설정을 하지 않으면 학습은 디폴트 평가 지표를 최적화하는 방향으로 이루어진다(디폴트가 무엇인지는 찾기가 어렵다…). 원한다면 이 값도 변경이 가능하니 <a href="https://cloud.google.com/automl-tables/docs/train#opt-obj">참고</a>하자.</p><h3 id="학습-시-유의사항"> <a href="#학습-시-유의사항" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> 학습 시 유의사항</h3><p>각 컬럼의 타입이 적절히 지정되었는지 확인이 필요하다.</p><ul><li>자연어가 가능한 필드는 Text 필드로 지정되어야 한다.<li>실제는 Categorical 필드인데 Numeric 으로 지정된 필드는 없는지 확인한다(ex. Red=1, Yellow=2).</ul><p>아래와 같이 학습을 방해하는 컬럼은 학습에서 배제하는것이 필요하다.</p><ul><li>의도하지 않은 Missing value 나 Invalid value 가 많은 컬럼<li>ID와 같이 거의 대부분의 row가 서로 다른 값을 지니는 컬럼<li>Target 컬럼과 연관성이 높은데, 사실은 Target 에 의해 유도되는 컬럼</ul><p><br /></p><h2 id="evaluation"> <a href="#evaluation" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Evaluation</h2><p>모델 학습을 완료했으면 이제 해당 모델의 성능을 평가해서 적용 유무를 결정해야한다. AutoML Tables 에서는 아래와 같은 평가 지표들 제공하며, 이를 활용해서 모델 성능이 비즈니스 요구사항에 부합하는지 평가가 가능하다.</p><h3 id="classification-모델인-경우"> <a href="#classification-모델인-경우" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Classification 모델인 경우</h3><p>문제 타입이 Classification인 경우, 아래와 같은 지표들을 활용할 수 있다.</p><ul><li>AUC PR (Area Under the Precision-Recall Curve)<li>AUC ROC (Area Under the Receiver Operating Characteristic Curve)<li>Accuracy<li>Log loss<li>F1 score<li>Precision<li>Recall<li>False positive rate</ul><h3 id="regression-모델인-경우"> <a href="#regression-모델인-경우" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Regression 모델인 경우</h3><ul><li>MAE (Mean Absolute Error)<li>RMSE (Root Mean Square Error)<li>RMSLE (Root Mean Squared Logarithmic Error)<li>R^2 (R Squared)<li>MAPE (Mean Absolute Percentage Error)</ul><p>또한, 문제 타입에 관계없이 <strong>Feature importance</strong>를 제공하므로, 무의미한 Feature가 사용되지는 않았는지 추가적으로 확인할 수 있다.</p><p>AutoML Tables 에서는 이러한 지표들을 획득하기 위한 인터페이스로 <a href="https://cloud.google.com/automl-tables/docs/evaluate#automl-tables-list-model-evaluations-console">GCP Console</a>과 <a href="https://cloud.google.com/automl-tables/docs/evaluate#automl-tables-list-model-evaluations-cli-curl">Restful API</a>를 제공한다.</p><p><br /></p><h2 id="prediction"> <a href="#prediction" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Prediction</h2><p>TBD</p><h2 id="references"> <a href="#references" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> References</h2><ul><li><a href="https://cloud.google.com/automl-tables/docs/">AutoML Tables documentation</a></ul><hr><footer role="contentinfo"><p class="text-small text-grey-dk-000 mb-0">Copyright (C) 2019 Hyeonguk Jang.</p></footer></div></div></div></div>
